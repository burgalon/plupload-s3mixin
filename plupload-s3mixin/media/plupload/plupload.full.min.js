(function(){var f=0,k=[],m={},i={},a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},l=/[<>&\"\']/g,b,c=window.setTimeout,d={},e;function h(){this.returnValue=false}function j(){this.cancelBubble=true}(function(n){var o=n.split(/,/),p,r,q;for(p=0;p<o.length;p+=2){q=o[p+1].split(/ /);for(r=0;r<q.length;r++){i[q[r]]=o[p]}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/vnd.rn-realvideo,rv,text/plain,asc txt text diff log,application/octet-stream,exe");var g={STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-700,mimeTypes:i,extend:function(n){g.each(arguments,function(o,p){if(p>0){g.each(o,function(r,q){n[q]=r})}});return n},cleanName:function(n){var o,p;p=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(o=0;o<p.length;o+=2){n=n.replace(p[o],p[o+1])}n=n.replace(/\s+/g,"_");n=n.replace(/[^a-z0-9_\-\.]+/gi,"");return n},addRuntime:function(n,o){o.name=n;k[n]=o;k.push(o);return o},guid:function(){var n=new Date().getTime().toString(32),o;for(o=0;o<5;o++){n+=Math.floor(Math.random()*65535).toString(32)}return(g.guidPrefix||"p")+n+(f++).toString(32)},buildUrl:function(o,n){var p="";g.each(n,function(r,q){p+=(p?"&":"")+encodeURIComponent(q)+"="+encodeURIComponent(r)});if(p){o+=(o.indexOf("?")>0?"&":"?")+p}return o},each:function(q,r){var p,o,n;if(q){p=q.length;if(p===b){for(o in q){if(q.hasOwnProperty(o)){if(r(q[o],o)===false){return}}}}else{for(n=0;n<p;n++){if(r(q[n],n)===false){return}}}}},formatSize:function(n){if(n===b){return g.translate("N/A")}if(n>1048576){return Math.round(n/1048576,1)+" MB"}if(n>1024){return Math.round(n/1024,1)+" KB"}return n+" b"},getPos:function(o,s){var t=0,r=0,v,u=document,p,q;o=o;s=s||u.body;function n(B){var z,A,w=0,C=0;if(B){A=B.getBoundingClientRect();z=u.compatMode==="CSS1Compat"?u.documentElement:u.body;w=A.left+z.scrollLeft;C=A.top+z.scrollTop}return{x:w,y:C}}if(o.getBoundingClientRect&&(navigator.userAgent.indexOf("MSIE")>0&&u.documentMode!==8)){p=n(o);q=n(s);return{x:p.x-q.x,y:p.y-q.y}}v=o;while(v&&v!=s&&v.nodeType){t+=v.offsetLeft||0;r+=v.offsetTop||0;v=v.offsetParent}v=o.parentNode;while(v&&v!=s&&v.nodeType){t-=v.scrollLeft||0;r-=v.scrollTop||0;v=v.parentNode}return{x:t,y:r}},getSize:function(n){return{w:n.clientWidth||n.offsetWidth,h:n.clientHeight||n.offsetHeight}},parseSize:function(n){var o;if(typeof(n)=="string"){n=/^([0-9]+)([mgk]+)$/.exec(n.toLowerCase().replace(/[^0-9mkg]/g,""));o=n[2];n=+n[1];if(o=="g"){n*=1073741824}if(o=="m"){n*=1048576}if(o=="k"){n*=1024}}return n},xmlEncode:function(n){return n?(""+n).replace(l,function(o){return a[o]?"&"+a[o]+";":o}):n},toArray:function(p){var o,n=[];for(o=0;o<p.length;o++){n[o]=p[o]}return n},addI18n:function(n){return g.extend(m,n)},translate:function(n){return m[n]||n},hasClass:function(p,o){if(p.className==""){return false}var n=new RegExp("(^|\\s+)"+o+"(\\s+|$)");return n.test(p.className)},addClass:function(o,n){if(!g.hasClass(o,n)){o.className=o.className==""?n:o.className.replace(/\s+$/,"")+" "+n}},removeClass:function(p,o){var n=new RegExp("(^|\\s+)"+o+"(\\s+|$)");p.className=p.className.replace(n,function(r,q,s){return q==" "&&s==" "?" ":""})},addEvent:function(r,n,s){var q,p,o;n=n.toLowerCase();if(e===b){e="Plupload_"+g.guid()}if(r.attachEvent){q=function(){var t=window.event;if(!t.target){t.target=t.srcElement}t.preventDefault=h;t.stopPropagation=j;s(t)};r.attachEvent("on"+n,q)}else{if(r.addEventListener){q=s;r.addEventListener(n,q,false)}}if(r[e]===b){r[e]=g.guid()}if(!d.hasOwnProperty(r[e])){d[r[e]]={}}p=d[r[e]];if(!p.hasOwnProperty(n)){p[n]=[]}p[n].push({func:q,orig:s})},removeEvent:function(s,o){var q,t=arguments[2],n=function(u){for(var v in u){return false}return true};o=o.toLowerCase();if(e in s&&s[e] in d&&o in d[s[e]]){q=d[s[e]][o]}else{return}for(var p=q.length-1;p>=0;p--){if(t===b||q[p].orig==t){if(s.detachEvent){s.detachEvent("on"+o,q[p].func)}else{if(s.removeEventListener){s.removeEventListener(o,q[p].func,false)}}q[p].orig=null;q[p].func=null;if(t!==b){q.splice(p,1);break}}}if(t===b){q=[]}if(!q.length){delete d[s[e]][o]}if(n(d[s[e]])){delete d[s[e]];try{delete s[e]}catch(r){s[e]=b}}},removeAllEvents:function(n){if(n[e]===b||!d.hasOwnProperty(n[e])){return}g.each(d[n[e]],function(p,o){g.removeEvent(n,o)})}};g.Uploader=function(q){var o={},t,s=[],u,p;t=new g.QueueProgress();q=g.extend({chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",filters:[]},q);function r(){var v;if(this.state==g.STARTED&&u<s.length){v=s[u++];if(v.status==g.QUEUED){v.status=g.UPLOADING;this.trigger("BeforeUpload",v);this.trigger("UploadFile",v)}else{r.call(this)}}else{if(u==s.length){this.trigger("UploadComplete",v)}this.stop()}}function n(){var w,v;t.reset();for(w=0;w<s.length;w++){v=s[w];if(v.size!==b){t.size+=v.size;t.loaded+=v.loaded}else{t.size=b}if(v.status==g.DONE){t.uploaded++}else{if(v.status==g.FAILED){t.failed++}else{t.queued++}}}if(t.size===b){t.percent=s.length>0?Math.ceil(t.uploaded/s.length*100):0}else{t.bytesPerSec=Math.ceil(t.loaded/((+new Date()-p||1)/1000));t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):0}}g.extend(this,{state:g.STOPPED,runtime:"",features:{},files:s,settings:q,total:t,id:g.guid(),init:function(){var A=this,B,x,w,z=0,y;if(typeof(q.preinit)=="function"){q.preinit(A)}else{g.each(q.preinit,function(D,C){A.bind(C,D)})}q.page_url=q.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(q.url)){q.url=q.page_url+q.url}q.chunk_size=g.parseSize(q.chunk_size);q.max_file_size=g.parseSize(q.max_file_size);A.bind("FilesAdded",function(C,F){var E,D,H=0,I,G=q.filters;if(G&&G.length){I=[];g.each(G,function(J){g.each(J.extensions.split(/,/),function(K){I.push("\\."+K.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"))})});I=new RegExp(I.join("|")+"$","i")}for(E=0;E<F.length;E++){D=F[E];D.loaded=0;D.percent=0;D.status=g.QUEUED;if(I&&!I.test(D.name)){C.trigger("Error",{code:g.FILE_EXTENSION_ERROR,message:g.translate("File extension error."),file:D});continue}if(D.size!==b&&D.size>q.max_file_size){C.trigger("Error",{code:g.FILE_SIZE_ERROR,message:g.translate("File size error."),file:D});continue}s.push(D);H++}if(H){c(function(){A.trigger("QueueChanged");A.refresh()},1)}else{return false}});if(q.unique_names){A.bind("UploadFile",function(C,D){var F=D.name.match(/\.([^.]+)$/),E="tmp";if(F){E=F[1]}D.target_name=D.id+"."+E})}A.bind("UploadProgress",function(C,D){D.percent=D.size>0?Math.ceil(D.loaded/D.size*100):100;n()});A.bind("StateChanged",function(C){if(C.state==g.STARTED){p=(+new Date())}});A.bind("QueueChanged",n);A.bind("Error",function(C,D){if(D.file){D.file.status=g.FAILED;n();if(C.state==g.STARTED){c(function(){r.call(A)},1)}}});A.bind("FileUploaded",function(C,D){D.status=g.DONE;D.loaded=D.size;C.trigger("UploadProgress",D);c(function(){r.call(A)},1)});if(q.runtimes){x=[];y=q.runtimes.split(/\s?,\s?/);for(B=0;B<y.length;B++){if(k[y[B]]){x.push(k[y[B]])}}}else{x=k}function v(){var F=x[z++],E,C,D;if(F){E=F.getFeatures();C=A.settings.required_features;if(C){C=C.split(",");for(D=0;D<C.length;D++){if(!E[C[D]]){v();return}}}F.init(A,function(G){if(G&&G.success){A.features=E;A.runtime=F.name;A.trigger("Init",{runtime:F.name});A.trigger("PostInit");A.refresh()}else{v()}})}else{A.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}}v();if(typeof(q.init)=="function"){q.init(A)}else{g.each(q.init,function(D,C){A.bind(C,D)})}},refresh:function(){this.trigger("Refresh")},start:function(){if(this.state!=g.STARTED){u=0;this.state=g.STARTED;this.trigger("StateChanged");r.call(this)}},stop:function(){if(this.state!=g.STOPPED){this.state=g.STOPPED;this.trigger("StateChanged")}},getFile:function(w){var v;for(v=s.length-1;v>=0;v--){if(s[v].id===w){return s[v]}}},removeFile:function(w){var v;for(v=s.length-1;v>=0;v--){if(s[v].id===w.id){return this.splice(v,1)[0]}}},splice:function(x,v){var w;w=s.splice(x===b?0:x,v===b?s.length:v);this.trigger("FilesRemoved",w);this.trigger("QueueChanged");return w},trigger:function(w){var y=o[w.toLowerCase()],x,v;if(y){v=Array.prototype.slice.call(arguments);v[0]=this;for(x=0;x<y.length;x++){if(y[x].func.apply(y[x].scope,v)===false){return false}}}return true},bind:function(v,x,w){var y;v=v.toLowerCase();y=o[v]||[];y.push({func:x,scope:w||this});o[v]=y},unbind:function(v){v=v.toLowerCase();var y=o[v],w,x=arguments[1];if(y){if(x!==b){for(w=y.length-1;w>=0;w--){if(y[w].func===x){y.splice(w,1);break}}}else{y=[]}if(!y.length){delete o[v]}}},unbindAll:function(){var v=this;g.each(o,function(x,w){v.unbind(w)})},destroy:function(){this.trigger("Destroy");this.unbindAll()}})};g.File=function(q,o,p){var n=this;n.id=q;n.name=o;n.size=p;n.loaded=0;n.percent=0;n.status=0};g.Runtime=function(){this.getFeatures=function(){};this.init=function(n,o){}};g.QueueProgress=function(){var n=this;n.size=0;n.loaded=0;n.uploaded=0;n.failed=0;n.queued=0;n.percent=0;n.bytesPerSec=0;n.reset=function(){n.size=n.loaded=n.uploaded=n.failed=n.queued=n.percent=n.bytesPerSec=0}};g.runtimes={};window.plupload=g})();(function(b){var c={};function a(j,f,m,l,d){var n,h,g,i;h=google.gears.factory.create("beta.canvas");try{h.decode(j);i=Math.min(f/h.width,m/h.height);if(i<1){h.resize(Math.round(h.width*i),Math.round(h.height*i));return h.encode(d,{quality:l/100})}}catch(k){}return j}b.runtimes.Gears=b.addRuntime("gears",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(g,i){var h;if(!window.google||!google.gears){return i({success:false})}try{h=google.gears.factory.create("beta.desktop")}catch(f){return i({success:false})}function d(k){var j,e,l=[],m;for(e=0;e<k.length;e++){j=k[e];m=b.guid();c[m]=j.blob;l.push(new b.File(m,j.name,j.blob.length))}g.trigger("FilesAdded",l)}g.bind("PostInit",function(){var j=g.settings,e=document.getElementById(j.drop_element);if(e){b.addEvent(e,"dragover",function(k){h.setDropEffect(k,"copy");k.preventDefault()});b.addEvent(e,"drop",function(l){var k=h.getDragData(l,"application/x-gears-files");if(k){d(k.files)}l.preventDefault()});e=0}b.addEvent(document.getElementById(j.browse_button),"click",function(o){var n=[],l,k,m;o.preventDefault();for(l=0;l<j.filters.length;l++){m=j.filters[l].extensions.split(",");for(k=0;k<m.length;k++){n.push("."+m[k])}}h.openFiles(d,{singleFile:!j.multi_selection,filter:n})})});g.bind("UploadFile",function(o,l){var q=0,p,m,n=0,k=o.settings.resize,e;if(k&&/\.(png|jpg|jpeg)$/i.test(l.name)){c[l.id]=a(c[l.id],k.width,k.height,k.quality||90,/\.png$/i.test(l.name)?"image/png":"image/jpeg")}l.size=c[l.id].length;m=o.settings.chunk_size;e=m>0;p=Math.ceil(l.size/m);if(!e){m=l.size;p=1}function j(){var v,x,s=o.settings.multipart,r=0,w={name:l.target_name||l.name},t=o.settings.url;function u(z){var y,E="----pluploadboundary"+b.guid(),B="--",D="\r\n",A,C;if(s){v.setRequestHeader("Content-Type","multipart/form-data; boundary="+E);y=google.gears.factory.create("beta.blobbuilder");b.each(b.extend(w,o.settings.multipart_params),function(G,F){y.append(B+E+D+'Content-Disposition: form-data; name="'+F+'"'+D+D);y.append(G+D)});C=b.mimeTypes[l.name.replace(/^.+\.([^.]+)/,"$1")]||"application/octet-stream";y.append(B+E+D+'Content-Disposition: form-data; name="'+o.settings.file_data_name+'"; filename="'+l.name+'"'+D+"Content-Type: "+C+D+D);y.append(z);y.append(D+B+E+B+D);A=y.getAsBlob();r=A.length-z.length;z=A}v.send(z)}if(l.status==b.DONE||l.status==b.FAILED||o.state==b.STOPPED){return}if(e){w.chunk=q;w.chunks=p}x=Math.min(m,l.size-(q*m));if(!s){t=b.buildUrl(o.settings.url,w)}v=google.gears.factory.create("beta.httprequest");v.open("POST",t);if(!s){v.setRequestHeader("Content-Disposition",'attachment; filename="'+l.name+'"');v.setRequestHeader("Content-Type","application/octet-stream")}b.each(o.settings.headers,function(z,y){v.setRequestHeader(y,z)});v.upload.onprogress=function(y){l.loaded=n+y.loaded-r;o.trigger("UploadProgress",l)};v.onreadystatechange=function(){var y;if(v.readyState==4){if(v.status==200){y={chunk:q,chunks:p,response:v.responseText,status:v.status};o.trigger("ChunkUploaded",l,y);if(y.cancelled){l.status=b.FAILED;return}n+=x;if(++q>=p){l.status=b.DONE;o.trigger("FileUploaded",l,{response:v.responseText,status:v.status})}else{j()}}else{o.trigger("Error",{code:b.HTTP_ERROR,message:b.translate("HTTP Error."),file:l,chunk:q,chunks:p,status:v.status})}}};if(q<p){u(c[l.id].slice(q*m,x))}}j()});i({success:true})}})})(plupload);(function(c){var a={},e={};function b(m){var l,k=typeof m,j,f,h,g;if(k==="string"){l="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+m.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(o,n){var i=l.indexOf(n);if(i+1){return"\\"+l.charAt(i+1)}o=n.charCodeAt().toString(16);return"\\u"+"0000".substring(o.length)+o})+'"'}if(k=="object"){f=m.length!==j;l="";if(f){for(h=0;h<m.length;h++){if(l){l+=","}l+=b(m[h])}l="["+l+"]"}else{for(g in m){if(m.hasOwnProperty(g)){if(l){l+=","}l+=b(g)+":"+b(m[g])}}l="{"+l+"}"}return l}if(m===j){return"null"}return""+m}function d(o){var r=false,f=null,k=null,g,h,i,q,j,m=0;try{try{k=new ActiveXObject("AgControl.AgControl");if(k.IsVersionSupported(o)){r=true}k=null}catch(n){var l=navigator.plugins["Silverlight Plug-In"];if(l){g=l.description;if(g==="1.0.30226.2"){g="2.0.30226.2"}h=g.split(".");while(h.length>3){h.pop()}while(h.length<4){h.push(0)}i=o.split(".");while(i.length>4){i.pop()}do{q=parseInt(i[m],10);j=parseInt(h[m],10);m++}while(m<i.length&&q===j);if(q<=j&&!isNaN(q)){r=true}}}}catch(p){r=false}return r}c.silverlight={trigger:function(k,g){var j=a[k],h,f;if(j){f=c.toArray(arguments).slice(1);f[0]="Silverlight:"+g;setTimeout(function(){j.trigger.apply(j,f)},0)}}};c.runtimes.Silverlight=c.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(m,n){var l,j="",k=m.settings.filters,h,g=document.body;if(!d("2.0.31005.0")||(window.opera&&window.opera.buildNumber)){n({success:false});return}e[m.id]=false;a[m.id]=m;l=document.createElement("div");l.id=m.id+"_silverlight_container";c.extend(l.style,{position:"absolute",top:"0px",background:m.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:m.settings.shim_bgcolor||document.documentMode>8?"":0.01});l.className="plupload silverlight";if(m.settings.container){g=document.getElementById(m.settings.container);g.style.position="relative"}g.appendChild(l);for(h=0;h<k.length;h++){j+=(j!=""?"|":"")+k[h].title+" | *."+k[h].extensions.replace(/,/g,";*.")}l.innerHTML='<object id="'+m.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+m.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+m.id+",filter="+j+'"/></object>';function f(){return document.getElementById(m.id+"_silverlight").content.Upload}m.bind("Silverlight:Init",function(){var i,o={};if(e[m.id]){return}e[m.id]=true;m.bind("Silverlight:StartSelectFiles",function(p){i=[]});m.bind("Silverlight:SelectFile",function(p,s,q,r){var t;t=c.guid();o[t]=s;o[s]=t;i.push(new c.File(t,q,r))});m.bind("Silverlight:SelectSuccessful",function(){if(i.length){m.trigger("FilesAdded",i)}});m.bind("Silverlight:UploadChunkError",function(p,s,q,t,r){m.trigger("Error",{code:c.IO_ERROR,message:"IO Error.",details:r,file:p.getFile(o[s])})});m.bind("Silverlight:UploadFileProgress",function(p,t,q,s){var r=p.getFile(o[t]);if(r.status!=c.FAILED){r.size=s;r.loaded=q;p.trigger("UploadProgress",r)}});m.bind("Refresh",function(p){var q,r,s;q=document.getElementById(p.settings.browse_button);r=c.getPos(q,document.getElementById(p.settings.container));s=c.getSize(q);c.extend(document.getElementById(p.id+"_silverlight_container").style,{top:r.y+"px",left:r.x+"px",width:s.w+"px",height:s.h+"px"})});m.bind("Silverlight:UploadChunkSuccessful",function(p,s,q,v,u){var t,r=p.getFile(o[s]);t={chunk:q,chunks:v,response:u};p.trigger("ChunkUploaded",r,t);if(r.status!=c.FAILED){f().UploadNextChunk()}if(q==v-1){r.status=c.DONE;p.trigger("FileUploaded",r,{response:u})}});m.bind("Silverlight:UploadSuccessful",function(p,s,q){var r=p.getFile(o[s]);r.status=c.DONE;p.trigger("FileUploaded",r,{response:q})});m.bind("FilesRemoved",function(p,r){var q;for(q=0;q<r.length;q++){f().RemoveFile(o[r[q].id])}});m.bind("UploadFile",function(p,r){var s=p.settings,q=s.resize||{};f().UploadFile(o[r.id],p.settings.url,b({name:r.target_name||r.name,mime:c.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1")]||"application/octet-stream",chunk_size:s.chunk_size,image_width:q.width,image_height:q.height,image_quality:q.quality||90,multipart:!!s.multipart,multipart_params:s.multipart_params||{},headers:s.headers}))});n({success:true})})}})})(plupload);(function(c){var a={},d={};function b(){var e;try{e=navigator.plugins["Shockwave Flash"];e=e.description}catch(g){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(f){e="0.0"}}e=e.match(/\d+/g);return parseFloat(e[0]+"."+e[1])}c.flash={trigger:function(g,e,f){setTimeout(function(){var k=a[g],j,h;if(k){k.trigger("Flash:"+e,f)}},0)}};c.runtimes.Flash=c.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(g,l){var k,f,h,m=0,e=document.body;if(b()<10){l({success:false});return}d[g.id]=false;a[g.id]=g;k=document.getElementById(g.settings.browse_button);f=document.createElement("div");f.id=g.id+"_flash_container";c.extend(f.style,{position:"absolute",top:"0px",background:g.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});f.className="plupload flash";if(g.settings.container){e=document.getElementById(g.settings.container);e.style.position="relative"}e.appendChild(f);h="id="+escape(g.id);f.innerHTML='<object id="'+g.id+'_flash" width="100%" height="100%" style="outline:0" type="application/x-shockwave-flash" data="'+g.settings.flash_swf_url+'"><param name="movie" value="'+g.settings.flash_swf_url+'" /><param name="flashvars" value="'+h+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';function j(){return document.getElementById(g.id+"_flash")}function i(){if(m++>5000){l({success:false});return}if(!d[g.id]){setTimeout(i,1)}}i();k=f=null;g.bind("Flash:Init",function(){var p={},o,n=g.settings.resize||{};j().setFileFilters(g.settings.filters,g.settings.multi_selection);if(d[g.id]){return}d[g.id]=true;g.bind("UploadFile",function(q,r){var s=q.settings;j().uploadFile(p[r.id],s.url,{name:r.target_name||r.name,mime:c.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1")]||"application/octet-stream",chunk_size:s.chunk_size,width:n.width,height:n.height,quality:n.quality||90,multipart:s.multipart,multipart_params:s.multipart_params||{},file_data_name:s.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:s.headers,urlstream_upload:s.urlstream_upload})});g.bind("Flash:UploadProcess",function(r,q){var s=r.getFile(p[q.id]);if(s.status!=c.FAILED){s.loaded=q.loaded;s.size=q.size;r.trigger("UploadProgress",s)}});g.bind("Flash:UploadChunkComplete",function(q,s){var t,r=q.getFile(p[s.id]);t={chunk:s.chunk,chunks:s.chunks,response:s.text};q.trigger("ChunkUploaded",r,t);if(r.status!=c.FAILED){j().uploadNextChunk()}if(s.chunk==s.chunks-1){r.status=c.DONE;q.trigger("FileUploaded",r,{response:s.text})}});g.bind("Flash:SelectFiles",function(q,t){var s,r,u=[],v;for(r=0;r<t.length;r++){s=t[r];v=c.guid();p[v]=s.id;p[s.id]=v;u.push(new c.File(v,s.name,s.size))}if(u.length){g.trigger("FilesAdded",u)}});g.bind("Flash:SecurityError",function(q,r){g.trigger("Error",{code:c.SECURITY_ERROR,message:c.translate("Security error."),details:r.message,file:g.getFile(p[r.id])})});g.bind("Flash:GenericError",function(q,r){g.trigger("Error",{code:c.GENERIC_ERROR,message:c.translate("Generic error."),details:r.message,file:g.getFile(p[r.id])})});g.bind("Flash:IOError",function(q,r){g.trigger("Error",{code:c.IO_ERROR,message:c.translate("IO error."),details:r.message,file:g.getFile(p[r.id])})});g.bind("Flash:StageEvent:rollOver",function(q){var r,s;r=document.getElementById(g.settings.browse_button);s=q.settings.browse_button_hover;if(r&&s){c.addClass(r,s)}});g.bind("Flash:StageEvent:rollOut",function(q){var r,s;r=document.getElementById(g.settings.browse_button);s=q.settings.browse_button_hover;if(r&&s){c.removeClass(r,s)}});g.bind("Flash:StageEvent:mouseDown",function(q){var r,s;r=document.getElementById(g.settings.browse_button);s=q.settings.browse_button_active;if(r&&s){c.addClass(r,s);c.addEvent(document.body,"mouseup",function(){c.removeClass(r,s)})}});g.bind("Flash:StageEvent:mouseUp",function(q){var r,s;r=document.getElementById(g.settings.browse_button);s=q.settings.browse_button_active;if(r&&s){c.removeClass(r,s)}});g.bind("QueueChanged",function(q){g.refresh()});g.bind("FilesRemoved",function(q,s){var r;for(r=0;r<s.length;r++){j().removeFile(p[s[r].id])}});g.bind("StateChanged",function(q){g.refresh()});g.bind("Refresh",function(q){var r,s,t;j().setFileFilters(g.settings.filters,g.settings.multi_selection);r=document.getElementById(q.settings.browse_button);s=c.getPos(r,document.getElementById(q.settings.container));t=c.getSize(r);c.extend(document.getElementById(q.id+"_flash_container").style,{top:s.y+"px",left:s.x+"px",width:t.w+"px",height:t.h+"px"})});l({success:true})})}})})(plupload);(function(a){a.runtimes.BrowserPlus=a.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(g,i){var e=window.BrowserPlus,h={},d=g.settings,c=d.resize;function f(n){var m,l,j=[],k,o;for(l=0;l<n.length;l++){k=n[l];o=a.guid();h[o]=k;j.push(new a.File(o,k.name,k.size))}if(l){g.trigger("FilesAdded",j)}}function b(){g.bind("PostInit",function(){var m,k=d.drop_element,o=g.id+"_droptarget",j=document.getElementById(k),l;function p(r,q){e.DragAndDrop.AddDropTarget({id:r},function(s){e.DragAndDrop.AttachCallbacks({id:r,hover:function(t){if(!t&&q){q()}},drop:function(t){if(q){q()}f(t)}},function(){})})}function n(){document.getElementById(o).style.top="-1000px"}if(j){if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){m=document.createElement("div");m.setAttribute("id",o);a.extend(m.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(m);a.addEvent(j,"dragenter",function(r){var q,s;q=document.getElementById(k);s=a.getPos(q);a.extend(document.getElementById(o).style,{top:s.y+"px",left:s.x+"px",width:q.offsetWidth+"px",height:q.offsetHeight+"px"})});p(o,n)}else{p(k)}}a.addEvent(document.getElementById(d.browse_button),"click",function(v){var t=[],r,q,u=d.filters,s;v.preventDefault();for(r=0;r<u.length;r++){s=u[r].extensions.split(",");for(q=0;q<s.length;q++){t.push(a.mimeTypes[s[q]])}}e.FileBrowse.OpenBrowseDialog({mimeTypes:t},function(w){if(w.success){f(w.value)}})});j=m=null});g.bind("UploadFile",function(m,j){var l=h[j.id],r={},k=m.settings.chunk_size,n,o=[];function q(s,u){var t;if(j.status==a.FAILED){return}r.name=j.target_name||j.name;if(k){r.chunk=""+s;r.chunks=""+u}t=o.shift();e.Uploader.upload({url:m.settings.url,files:{file:t},cookies:document.cookies,postvars:a.extend(r,m.settings.multipart_params),progressCallback:function(x){var w,v=0;n[s]=parseInt(x.filePercent*t.size/100,10);for(w=0;w<n.length;w++){v+=n[w]}j.loaded=v;m.trigger("UploadProgress",j)}},function(w){var v,x;if(w.success){v=w.value.statusCode;if(k){m.trigger("ChunkUploaded",j,{chunk:s,chunks:u,response:w.value.body,status:v})}if(o.length>0){q(++s,u)}else{j.status=a.DONE;m.trigger("FileUploaded",j,{response:w.value.body,status:v});if(v>=400){m.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:j,status:v})}}}else{m.trigger("Error",{code:a.GENERIC_ERROR,message:a.translate("Generic Error."),file:j,details:w.error})}})}function p(s){j.size=s.size;if(k){e.FileAccess.chunk({file:s,chunkSize:k},function(v){if(v.success){var w=v.value,t=w.length;n=Array(t);for(var u=0;u<t;u++){n[u]=0;o.push(w[u])}q(0,t)}})}else{n=Array(1);o.push(s);q(0,1)}}if(c&&/\.(png|jpg|jpeg)$/i.test(j.name)){BrowserPlus.ImageAlter.transform({file:l,quality:c.quality||90,actions:[{scale:{maxwidth:c.width,maxheight:c.height}}]},function(s){if(s.success){p(s.value.file)}})}else{p(l)}});i({success:true})}if(e){e.init(function(k){var j=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];if(c){j.push({service:"ImageAlter",version:"4"})}if(k.success){e.require({services:j},function(l){if(l.success){b()}else{i()}})}else{i()}})}else{i()}}})})(plupload);(function(window,document,plupload,undef){var fakeSafariDragDrop,ExifParser;function readFile(file,callback){var reader;if("FileReader" in window){reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(){callback(reader.result)}}else{return callback(file.getAsDataURL())}}function scaleImage(image_file,max_width,max_height,mime,callback){var canvas,context,img,scale;readFile(image_file,function(data){canvas=document.createElement("canvas");canvas.style.display="none";document.body.appendChild(canvas);context=canvas.getContext("2d");img=new Image();img.onload=function(){var width,height,percentage,APP1,parser;scale=Math.min(max_width/img.width,max_height/img.height);if(scale<1){width=Math.round(img.width*scale);height=Math.round(img.height*scale);canvas.width=width;canvas.height=height;context.drawImage(img,0,0,width,height);parser=new ExifParser();parser.init(atob(data.substring(data.indexOf("base64,")+7)));APP1=parser.APP1({width:width,height:height});data=canvas.toDataURL(mime);data=data.substring(data.indexOf("base64,")+7);data=atob(data);if(APP1){parser.init(data);parser.setAPP1(APP1);data=parser.getBinary()}canvas.parentNode.removeChild(canvas);callback({success:true,data:data})}else{callback({success:false})}};img.src=data})}plupload.runtimes.Html5=plupload.addRuntime("html5",{getFeatures:function(){var xhr,hasXhrSupport,hasProgress,dataAccessSupport,sliceSupport,win=window;hasXhrSupport=hasProgress=dataAccessSupport=sliceSupport=false;if(win.Uint8Array&&win.ArrayBuffer&&!!XMLHttpRequest.prototype.sendAsBinary){XMLHttpRequest.prototype.sendAsBinary=function(datastr){var data,ui8a,bb,blob;data=new ArrayBuffer(datastr.length);ui8a=new Uint8Array(data,0);for(var i=0;i<datastr.length;i++){ui8a[i]=(datastr.charCodeAt(i)&255)}bb=new BlobBuilder();bb.append(data);blob=bb.getBlob();this.send(blob)}}if(win.XMLHttpRequest){xhr=new XMLHttpRequest();hasProgress=!!xhr.upload;hasXhrSupport=!!(xhr.sendAsBinary||xhr.upload)}if(hasXhrSupport){dataAccessSupport=!!(File&&(File.prototype.getAsDataURL||win.FileReader)&&xhr.sendAsBinary);sliceSupport=!!(File&&File.prototype.slice)}fakeSafariDragDrop=navigator.userAgent.indexOf("Safari")>0&&navigator.vendor.indexOf("Apple")!==-1;return{html5:hasXhrSupport,dragdrop:win.mozInnerScreenX!==undef||sliceSupport||fakeSafariDragDrop,jpgresize:dataAccessSupport,pngresize:dataAccessSupport,multipart:dataAccessSupport||!!win.FileReader||!!win.FormData,progress:hasProgress,chunking:sliceSupport||dataAccessSupport,canOpenDialog:navigator.userAgent.indexOf("WebKit")!==-1||
/*@cc_on!@*/
false}},init:function(uploader,callback){var html5files={},features;function addSelectedFiles(native_files){var file,i,files=[],id;for(i=0;i<native_files.length;i++){file=native_files[i];id=plupload.guid();html5files[id]=file;files.push(new plupload.File(id,file.fileName,file.fileSize))}if(files.length){uploader.trigger("FilesAdded",files)}}features=this.getFeatures();if(!features.html5){callback({success:false});return}uploader.bind("Init",function(up){var inputContainer,browseButton,mimes=[],i,y,filters=up.settings.filters,ext,type,container=document.body;inputContainer=document.createElement("div");inputContainer.id=up.id+"_html5_container";for(i=0;i<filters.length;i++){ext=filters[i].extensions.split(/,/);for(y=0;y<ext.length;y++){type=plupload.mimeTypes[ext[y]];if(type){mimes.push(type)}}}plupload.extend(inputContainer.style,{position:"absolute",background:uploader.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:uploader.settings.shim_bgcolor?"":0});inputContainer.className="plupload html5";if(uploader.settings.container){container=document.getElementById(uploader.settings.container);container.style.position="relative"}container.appendChild(inputContainer);inputContainer.innerHTML='<input id="'+uploader.id+'_html5" style="width:100%;height:100%;" type="file" accept="'+mimes.join(",")+'" '+(uploader.settings.multi_selection?'multiple="multiple"':"")+" />";inputFile=document.getElementById(uploader.id+"_html5");inputFile.onchange=function(){addSelectedFiles(this.files);this.value=""};browseButton=document.getElementById(up.settings.browse_button);if(browseButton){var hoverClass=up.settings.browse_button_hover,activeClass=up.settings.browse_button_active,topElement=up.features.canOpenDialog?browseButton:inputContainer;if(hoverClass){plupload.addEvent(topElement,"mouseover",function(){plupload.addClass(browseButton,hoverClass)});plupload.addEvent(topElement,"mouseout",function(){plupload.removeClass(browseButton,hoverClass)})}if(activeClass){plupload.addEvent(topElement,"mousedown",function(){plupload.addClass(browseButton,activeClass)});plupload.addEvent(document.body,"mouseup",function(){plupload.removeClass(browseButton,activeClass)})}if(up.features.canOpenDialog){plupload.addEvent(browseButton,"click",function(e){document.getElementById(up.id+"_html5").click();e.preventDefault()})}}});uploader.bind("PostInit",function(){var dropElm=document.getElementById(uploader.settings.drop_element);if(dropElm){if(fakeSafariDragDrop){plupload.addEvent(dropElm,"dragenter",function(e){var dropInputElm,dropPos,dropSize;dropInputElm=document.getElementById(uploader.id+"_drop");if(!dropInputElm){dropInputElm=document.createElement("input");dropInputElm.setAttribute("type","file");dropInputElm.setAttribute("id",uploader.id+"_drop");dropInputElm.setAttribute("multiple","multiple");plupload.addEvent(dropInputElm,"change",function(){addSelectedFiles(this.files);plupload.removeEvent(dropInputElm,"change");dropInputElm.parentNode.removeChild(dropInputElm)});dropElm.appendChild(dropInputElm)}dropPos=plupload.getPos(dropElm,document.getElementById(uploader.settings.container));dropSize=plupload.getSize(dropElm);plupload.extend(dropElm.style,{position:"relative"});plupload.extend(dropInputElm.style,{position:"absolute",display:"block",top:0,left:0,width:dropSize.w+"px",height:dropSize.h+"px",opacity:0})});return}plupload.addEvent(dropElm,"dragover",function(e){e.preventDefault()});plupload.addEvent(dropElm,"drop",function(e){var dataTransfer=e.dataTransfer;if(dataTransfer&&dataTransfer.files){addSelectedFiles(dataTransfer.files)}e.preventDefault()})}});uploader.bind("Refresh",function(up){var browseButton,browsePos,browseSize,inputContainer,pzIndex;browseButton=document.getElementById(uploader.settings.browse_button);if(browseButton){browsePos=plupload.getPos(browseButton,document.getElementById(up.settings.container));browseSize=plupload.getSize(browseButton);inputContainer=document.getElementById(uploader.id+"_html5_container");plupload.extend(inputContainer.style,{top:browsePos.y+"px",left:browsePos.x+"px",width:browseSize.w+"px",height:browseSize.h+"px"});if(uploader.features.canOpenDialog){pzIndex=parseInt(browseButton.parentNode.style.zIndex);if(isNaN(pzIndex)){pzIndex=0}plupload.extend(browseButton.style,{position:"relative",zIndex:pzIndex});plupload.extend(inputContainer.style,{zIndex:pzIndex-1})}}});uploader.bind("UploadFile",function(up,file){var settings=up.settings,nativeFile,resize;function sendBinaryBlob(blob){var chunk=0,loaded=0;function uploadNextChunk(){var chunkBlob=blob,xhr,upload,chunks,args,multipartDeltaSize=0,boundary="----pluploadboundary"+plupload.guid(),chunkSize,curChunkSize,formData,dashdash="--",crlf="\r\n",multipartBlob="",mimeType,url=up.settings.url;if(file.status==plupload.DONE||file.status==plupload.FAILED||up.state==plupload.STOPPED){return}args={name:file.target_name||file.name};if(settings.chunk_size&&features.chunking){chunkSize=settings.chunk_size;chunks=Math.ceil(file.size/chunkSize);curChunkSize=Math.min(chunkSize,file.size-(chunk*chunkSize));if(typeof(blob)=="string"){chunkBlob=blob.substring(chunk*chunkSize,chunk*chunkSize+curChunkSize)}else{chunkBlob=blob.slice(chunk*chunkSize,curChunkSize)}args.chunk=chunk;args.chunks=chunks}else{curChunkSize=file.size}xhr=new XMLHttpRequest();upload=xhr.upload;if(upload){upload.onprogress=function(e){file.loaded=Math.min(file.size,loaded+e.loaded-multipartDeltaSize);up.trigger("UploadProgress",file)}}if(!up.settings.multipart||!features.multipart){url=plupload.buildUrl(up.settings.url,args)}else{args.name=file.target_name||file.name}xhr.open("post",url,true);xhr.onreadystatechange=function(){var httpStatus,chunkArgs;if(xhr.readyState==4){try{httpStatus=xhr.status}catch(ex){httpStatus=0}if(httpStatus>=400){up.trigger("Error",{code:plupload.HTTP_ERROR,message:plupload.translate("HTTP Error."),file:file,status:httpStatus})}else{if(chunks){chunkArgs={chunk:chunk,chunks:chunks,response:xhr.responseText,status:httpStatus};up.trigger("ChunkUploaded",file,chunkArgs);loaded+=curChunkSize;if(chunkArgs.cancelled){file.status=plupload.FAILED;return}file.loaded=Math.min(file.size,(chunk+1)*chunkSize)}else{file.loaded=file.size}up.trigger("UploadProgress",file);if(!chunks||++chunk>=chunks){file.status=plupload.DONE;up.trigger("FileUploaded",file,{response:xhr.responseText,status:httpStatus});nativeFile=blob=html5files[file.id]=null}else{uploadNextChunk()}}xhr=chunkBlob=formData=multipartBlob=null}};plupload.each(up.settings.headers,function(value,name){xhr.setRequestHeader(name,value)});if(up.settings.multipart&&features.multipart){if(!xhr.sendAsBinary){formData=new FormData();plupload.each(plupload.extend(args,up.settings.multipart_params),function(value,name){formData.append(name,value)});formData.append(up.settings.file_data_name,chunkBlob);xhr.send(formData);return}xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+boundary);plupload.each(plupload.extend(args,up.settings.multipart_params),function(value,name){multipartBlob+=dashdash+boundary+crlf+'Content-Disposition: form-data; name="'+name+'"'+crlf+crlf;multipartBlob+=unescape(encodeURIComponent(value))+crlf});mimeType=plupload.mimeTypes[file.name.replace(/^.+\.([^.]+)/,"$1")]||"application/octet-stream";multipartBlob+=dashdash+boundary+crlf+'Content-Disposition: form-data; name="'+up.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(file.name))+'"'+crlf+"Content-Type: "+mimeType+crlf+crlf+chunkBlob+crlf+dashdash+boundary+dashdash+crlf;multipartDeltaSize=multipartBlob.length-chunkBlob.length;chunkBlob=multipartBlob}else{xhr.setRequestHeader("Content-Type","application/octet-stream")}if(xhr.sendAsBinary){xhr.sendAsBinary(chunkBlob)}else{xhr.send(chunkBlob)}}uploadNextChunk()}nativeFile=html5files[file.id];resize=up.settings.resize;if(features.jpgresize){if(resize&&/\.(png|jpg|jpeg)$/i.test(file.name)){scaleImage(nativeFile,resize.width,resize.height,/\.png$/i.test(file.name)?"image/png":"image/jpeg",function(res){if(res.success){file.size=res.data.length;sendBinaryBlob(res.data)}else{sendBinaryBlob(nativeFile.getAsBinary())}})}else{sendBinaryBlob(nativeFile.getAsBinary())}}else{sendBinaryBlob(nativeFile)}});uploader.bind("Destroy",function(up){var name,element,container=document.body,elements={inputContainer:up.id+"_html5_container",inputFile:up.id+"_html5",browseButton:up.settings.browse_button,dropElm:up.settings.drop_element};for(name in elements){element=document.getElementById(elements[name]);if(element){plupload.removeAllEvents(element)}}plupload.removeAllEvents(document.body);if(up.settings.container){container=document.getElementById(up.settings.container)}container.removeChild(document.getElementById(elements.inputContainer))});callback({success:true})}});ExifParser=function(){var Tiff,Exif,GPS,app0,app0_offset,app0_length,app1,app1_offset,data,app1_length,exifIFD_offset,gpsIFD_offset,IFD0_offset,TIFFHeader_offset,undef,tiffTags,exifTags,gpsTags,tagDescs;function BinaryReader(){var II=false,bin;function read(idx,size){var mv=II?0:-8*(size-1),sum=0,i;for(i=0;i<size;i++){sum|=(bin.charCodeAt(idx+i)<<Math.abs(mv+i*8))}return sum}function putstr(idx,segment,replace){bin=bin.substr(0,idx)+segment+bin.substr((replace===true?segment.length:0)+idx)}function write(idx,num,size){var str="",mv=II?0:-8*(size-1),i;for(i=0;i<size;i++){str+=String.fromCharCode((num>>Math.abs(mv+i*8))&255)}putstr(idx,str,true)}return{II:function(order){if(order===undef){return II}else{II=order}},init:function(binData){bin=binData},SEGMENT:function(idx,segment,replace){if(!arguments.length){return bin}if(typeof segment=="number"){return bin.substr(parseInt(idx,10),segment)}putstr(idx,segment,replace)},BYTE:function(idx){return read(idx,1)},SHORT:function(idx){return read(idx,2)},LONG:function(idx,num){if(num===undef){return read(idx,4)}else{write(idx,num,4)}},SLONG:function(idx){var num=read(idx,4);return(num>2147483647?num-4294967296:num)},STRING:function(idx,size){var str="";for(size+=idx;idx<size;idx++){str+=String.fromCharCode(read(idx,1))}return str}}}data=new BinaryReader();tiffTags={274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"};exifTags={36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"};gpsTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"};tagDescs={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};function extractTags(IFD_offset,tags2extract){var length=data.SHORT(IFD_offset),i,ii,tag,type,count,tagOffset,offset,value,values=[],tags={};for(i=0;i<length;i++){offset=tagOffset=IFD_offset+12*i+2;tag=tags2extract[data.SHORT(offset)];if(tag===undef){continue}type=data.SHORT(offset+=2);count=data.LONG(offset+=2);offset+=4;values=[];switch(type){case 1:case 7:if(count>4){offset=data.LONG(offset)+TIFFHeader_offset}for(ii=0;ii<count;ii++){values[ii]=data.BYTE(offset+ii)}break;case 2:if(count>4){offset=data.LONG(offset)+TIFFHeader_offset}tags[tag]=data.STRING(offset,count-1);continue;case 3:if(count>2){offset=data.LONG(offset)+TIFFHeader_offset}for(ii=0;ii<count;ii++){values[ii]=data.SHORT(offset+ii*2)}break;case 4:if(count>1){offset=data.LONG(offset)+TIFFHeader_offset}for(ii=0;ii<count;ii++){values[ii]=data.LONG(offset+ii*4)}break;case 5:offset=data.LONG(offset)+TIFFHeader_offset;for(ii=0;ii<count;ii++){values[ii]=data.LONG(offset+ii*4)/data.LONG(offset+ii*4+4)}break;case 9:offset=data.LONG(offset)+TIFFHeader_offset;for(ii=0;ii<count;ii++){values[ii]=data.SLONG(offset+ii*4)}break;case 10:offset=data.LONG(offset)+TIFFHeader_offset;for(ii=0;ii<count;ii++){values[ii]=data.SLONG(offset+ii*4)/data.SLONG(offset+ii*4+4)}break;default:continue}value=(count==1?values[0]:values);if(tagDescs.hasOwnProperty(tag)&&typeof value!="object"){tags[tag]=tagDescs[tag][value]}else{tags[tag]=value}}return tags}function getIFDOffsets(){var idx=app1_offset+4;TIFFHeader_offset+=app1_offset;if(data.STRING(idx,4).toUpperCase()!=="EXIF"||data.SHORT(idx+=4)!==0){return}data.II(data.SHORT(idx+=2)==18761);if(data.SHORT(idx+=2)!==42){return}IFD0_offset=TIFFHeader_offset+data.LONG(idx+=2);Tiff=extractTags(IFD0_offset,tiffTags);exifIFD_offset=("ExifIFDPointer" in Tiff?TIFFHeader_offset+Tiff.ExifIFDPointer:undef);gpsIFD_offset=("GPSInfoIFDPointer" in Tiff?TIFFHeader_offset+Tiff.GPSInfoIFDPointer:undef);return true}function findTagValueOffset(data_app1,tegHex,offset){var length=data_app1.SHORT(offset),tagOffset,i;for(i=0;i<length;i++){tagOffset=offset+12*i+2;if(data_app1.SHORT(tagOffset)==tegHex){return tagOffset+8}}}function setNewWxH(width,height){var w_offset,h_offset,offset=exifIFD_offset!=undef?exifIFD_offset-app1_offset:undef,data_app1=new BinaryReader();data_app1.init(app1);data_app1.II(data.II());if(offset===undef){return}w_offset=findTagValueOffset(data_app1,40962,offset);if(w_offset!==undef){data_app1.LONG(w_offset,width)}h_offset=findTagValueOffset(data_app1,40963,offset);if(h_offset!==undef){data_app1.LONG(h_offset,height)}app1=data_app1.SEGMENT()}return{init:function(jpegData){TIFFHeader_offset=10;Tiff=Exif=GPS=app0=app0_offset=app0_length=app1=app1_offset=app1_length=undef;data.init(jpegData);if(data.SHORT(0)!==65496){return false}switch(data.SHORT(2)){case 65504:app0_offset=2;app0_length=data.SHORT(4)+2;if(data.SHORT(app0_length)==65505){app1_offset=app0_length;app1_length=data.SHORT(app0_length+2)+2}break;case 65505:app1_offset=2;app1_length=data.SHORT(4)+2;break;default:return false}if(app1_length!==undef){getIFDOffsets()}},APP1:function(args){if(app1_offset===undef&&app1_length===undef){return}app1=app1||(app1=data.SEGMENT(app1_offset,app1_length));if(args!==undef&&"width" in args&&"height" in args){setNewWxH(args.width,args.height)}return app1},EXIF:function(){Exif=extractTags(exifIFD_offset,exifTags);Exif.ExifVersion=String.fromCharCode(Exif.ExifVersion[0],Exif.ExifVersion[1],Exif.ExifVersion[2],Exif.ExifVersion[3]);return Exif},GPS:function(){GPS=extractTags(gpsIFD_offset,gpsTags);GPS.GPSVersionID=GPS.GPSVersionID.join(".");return GPS},setAPP1:function(data_app1){if(app1_offset!==undef){return false}data.SEGMENT((app0_offset?app0_offset+app0_length:2),data_app1)},getBinary:function(){return data.SEGMENT()}}}})(window,document,plupload);(function(plupload){function getById(id){return document.getElementById(id)}plupload.runtimes.Html4=plupload.addRuntime("html4",{getFeatures:function(){return{multipart:true,canOpenDialog:navigator.userAgent.indexOf("WebKit")!==-1||
/*@cc_on!@*/
false}},init:function(uploader,callback){uploader.bind("Init",function(up){var container=document.body,iframe,url="javascript",currentFile,input,currentFileId,IE=/MSIE/.test(navigator.userAgent),mimes=[],filters=up.settings.filters,i,ext,type,y;for(i=0;i<filters.length;i++){ext=filters[i].extensions.split(/,/);for(y=0;y<ext.length;y++){type=plupload.mimeTypes[ext[y]];if(type){mimes.push(type)}}}mimes=mimes.join(",");function createForm(){var form,input,bgcolor,browseButton;currentFileId=plupload.guid();form=document.createElement("form");form.setAttribute("id","form_"+currentFileId);form.setAttribute("method","post");form.setAttribute("enctype","multipart/form-data");form.setAttribute("encoding","multipart/form-data");form.setAttribute("target",up.id+"_iframe");form.style.position="absolute";input=document.createElement("input");input.setAttribute("id","input_"+currentFileId);input.setAttribute("type","file");input.setAttribute("accept",mimes);input.setAttribute("size",1);browseButton=getById(up.settings.browse_button);if(up.features.canOpenDialog&&browseButton){plupload.addEvent(getById(up.settings.browse_button),"click",function(e){input.click();e.preventDefault()})}plupload.extend(input.style,{width:"100%",height:"100%",opacity:0});plupload.extend(form.style,{overflow:"hidden"});bgcolor=up.settings.shim_bgcolor;if(bgcolor){form.style.background=bgcolor}if(IE){plupload.extend(input.style,{filter:"alpha(opacity=0)"})}plupload.addEvent(input,"change",function(e){var element=e.target,name,files=[],topElement;if(element.value){getById("form_"+currentFileId).style.top=-1048575+"px";name=element.value.replace(/\\/g,"/");name=name.substring(name.length,name.lastIndexOf("/")+1);files.push(new plupload.File(currentFileId,name));if(!up.features.canOpenDialog){plupload.removeAllEvents(form)}else{plupload.removeEvent(browseButton,"click")}plupload.removeEvent(input,"change");createForm();if(files.length){uploader.trigger("FilesAdded",files)}}});form.appendChild(input);container.appendChild(form);up.refresh()}function createIframe(){var temp=document.createElement("div");temp.innerHTML='<iframe id="'+up.id+'_iframe" name="'+up.id+'_iframe" src="'+url+':&quot;&quot;" style="display:none"></iframe>';iframe=temp.firstChild;container.appendChild(iframe);plupload.addEvent(iframe,"load",function(e){var n=e.target,el,result;if(!currentFile){return}try{el=n.contentWindow.document||n.contentDocument||window.frames[n.id].document}catch(ex){up.trigger("Error",{code:plupload.SECURITY_ERROR,message:plupload.translate("Security error."),file:currentFile});return}result=el.documentElement.innerText||el.documentElement.textContent;if(result){currentFile.status=plupload.DONE;currentFile.loaded=1025;currentFile.percent=100;up.trigger("UploadProgress",currentFile);up.trigger("FileUploaded",currentFile,{response:result})}});up.bind("UploadFile",function(up,file){var form,input;if(file.status==plupload.DONE||file.status==plupload.FAILED||up.state==plupload.STOPPED){return}form=getById("form_"+file.id);input=getById("input_"+file.id);input.setAttribute("name",up.settings.file_data_name);form.setAttribute("action",up.settings.url);plupload.each(plupload.extend({name:file.target_name||file.name},up.settings.multipart_params),function(value,name){var input=document.createElement("input");plupload.extend(input,{type:"hidden",name:name,value:value});form.insertBefore(input,form.firstChild)});currentFile=file;getById("form_"+currentFileId).style.top=-1048575+"px";form.submit();form.parentNode.removeChild(form)})}if(up.settings.container){container=getById(up.settings.container);container.style.position="relative"}up.bind("StateChanged",function(up){if(up.state==plupload.STARTED){createIframe()}if(up.state==plupload.STOPPED){window.setTimeout(function(){iframe.parentNode.removeChild(iframe)},0)}});up.bind("Refresh",function(up){var browseButton,topElement,hoverClass,activeClass,browsePos,browseSize,inputContainer,inputFile,pzIndex;browseButton=getById(up.settings.browse_button);if(browseButton){browsePos=plupload.getPos(browseButton,getById(up.settings.container));browseSize=plupload.getSize(browseButton);inputContainer=getById("form_"+currentFileId);inputFile=getById("input_"+currentFileId);plupload.extend(inputContainer.style,{top:browsePos.y+"px",left:browsePos.x+"px",width:browseSize.w+"px",height:browseSize.h+"px"});if(up.features.canOpenDialog){pzIndex=parseInt(browseButton.parentNode.style.zIndex);if(isNaN(pzIndex)){pzIndex=0}plupload.extend(browseButton.style,{position:"relative",zIndex:pzIndex});plupload.extend(inputContainer.style,{zIndex:pzIndex-1})}hoverClass=up.settings.browse_button_hover;activeClass=up.settings.browse_button_active;topElement=up.features.canOpenDialog?browseButton:inputContainer;if(hoverClass){plupload.addEvent(topElement,"mouseover",function(){plupload.addClass(browseButton,hoverClass)});plupload.addEvent(topElement,"mouseout",function(){plupload.removeClass(browseButton,hoverClass)})}if(activeClass){plupload.addEvent(topElement,"mousedown",function(){plupload.addClass(browseButton,activeClass)});plupload.addEvent(document.body,"mouseup",function(){plupload.removeClass(browseButton,activeClass)})}}});uploader.bind("FilesRemoved",function(up,files){var i,n;for(i=0;i<files.length;i++){n=getById("form_"+files[i].id);n.parentNode.removeChild(n)}});createForm()});callback({success:true})}})})(plupload);